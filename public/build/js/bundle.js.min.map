{"version":3,"sources":["clientes.js","usuarios.js"],"names":["dataTable","dataTableInit","dataTableOption","destroy","language","url","dom","buttons","extend","text","titleAttr","className","columnDefs","orderable","targets","async","resultado","fetch","clientes","json","tableBody","document","getElementById","innerHTML","forEach","cliente","index","row","createElement","nombre","apellidos","correo","telefono","documento_identidad","fecha_nacimiento","id","appendChild","addEventListener","e","target","classList","contains","querySelector","value","trim","datos","FormData","append","respuesta","method","body","console","log","error","subirActualizacionCliente","actualizarCliente","getAttribute","listarClients","$","DataTable","initDataTable","roles","1","2","3","estatus","0","usuarios","usuario","apellido","direccion","email","rol_id","fecha_creacion","listarUsers","window"],"mappings":"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","file":"bundle.js","sourcesContent":["(function () {\r\n    let dataTable;\r\n    let dataTableInit = false;\r\n\r\n    const clientes = [];\r\n    const cliente = [];\r\n\r\n    // Opciones de DataTables\r\n    const dataTableOption = {\r\n        destroy: true,\r\n        language: {\r\n            url: 'https://cdn.datatables.net/plug-ins/2.1.8/i18n/es-MX.json',\r\n        },\r\n        //dom: 'Bfrtip', // Agrega la sección para los botones\r\n        dom: '<\"row mb-2\"<\"d-flex justify-content-start col-sm-6\"f><\"d-flex justify-content-end col-sm-6\"B>>' +  // B-> botones, F -> búsqueda\r\n        '<\"row\"<\"col-sm-12\"tr>>' +             // T -> tabla\r\n         '<\"row d-flex justify-content-between\"<\"col d-flex justify-content-start\"l><\"col d-flex justify-content-center\"i><\"col d-flex justify-content-end\"p>>' ,  // L-> de entradas  - I -> número de resultados por página, P-> paginador\r\n        buttons: [\r\n            {\r\n                extend: 'excelHtml5',\r\n                text: '<i class=\"fa-solid fa-file-excel\"></i>',\r\n                titleAttr: 'Exportar a Excel',\r\n                className: 'btn btn-success'\r\n            },\r\n            {\r\n                extend: 'pdfHtml5',\r\n                text: '<i class=\"fa-solid fa-file-pdf\"></i>',\r\n                titleAttr: 'Exportar a PDF',\r\n                className: 'btn btn-danger'\r\n            },\r\n            {\r\n                extend: 'csvHtml5',\r\n                text: '<i class=\"fa-solid fa-file-csv\"></i>',\r\n                titleAttr: 'Exportar a CSV',\r\n                className: 'btn btn-primary'\r\n            },\r\n            {\r\n                extend: 'print',\r\n                text: '<i class=\"fa-solid fa-print\"></i>',\r\n                titleAttr: 'Imprimir',\r\n                className: 'btn btn-info'\r\n            }\r\n\r\n        ],\r\n        columnDefs: [\r\n            { orderable: false, targets: [3, 4, 7] }  // Desactiva la ordenación en la columna 8 (índice 7)\r\n        ]\r\n    };\r\n\r\n\r\n    //Ejecutar Funciones\r\n    initDataTable();\r\n\r\n    // Función para inicializar la DataTable\r\n    async function initDataTable() {\r\n        if (dataTableInit) {\r\n            dataTable.destroy();  // Destruye la DataTable si ya existe\r\n        }\r\n\r\n        await listarClients();  // Llama a la función para listar usuarios\r\n\r\n        // Inicializa la DataTable\r\n        dataTable = $(\"#datatable_clients\").DataTable(dataTableOption);\r\n\r\n        dataTableInit = true;  // Marca que la DataTable fue inicializada\r\n    }\r\n\r\n    // Función para listar los usuarios\r\n    async function listarClients() {\r\n        try {\r\n            const url = 'http://localhost:3000/api/clientes/listar';\r\n            const resultado = await fetch(url);\r\n            const clientes = await resultado.json();\r\n\r\n            // Selecciona el cuerpo de la tabla\r\n            const tableBody = document.getElementById('tableBody_clients');\r\n\r\n            // Limpia el contenido del tbody antes de agregar nuevas filas\r\n            tableBody.innerHTML = '';\r\n\r\n            // Recorre los clientes y genera las filas de la tabla\r\n            clientes.forEach((cliente, index) => {\r\n                // Crea una nueva fila\r\n                const row = document.createElement('tr');\r\n\r\n                // Agrega celdas (td) a la fila con la información que quieres mostrar\r\n                row.innerHTML = `\r\n                    <td>${index + 1}</td> \r\n                    <td>${cliente.nombre}</td>\r\n                    <td>${cliente.apellidos}</td>\r\n                    <td>${cliente.correo}</td>\r\n                    <td>${cliente.telefono}</td>\r\n                    <td>${cliente.documento_identidad}</td>\r\n                    <td>${cliente.fecha_nacimiento}</td>\r\n                    <td>\r\n                        <!-- Botón de editar que abre el modal -->\r\n                        <button class=\"btn btn-sm btn-primary\" data-toggle=\"modal\" data-target=\"#editarClienteModal${cliente.id}\">\r\n                            <i class=\"fa-solid fa-pen\"></i>\r\n                        </button>\r\n\r\n                        <!-- Modal Editar Cliente -->\r\n                        <div class=\"modal fade modal-editarCliente\" id=\"editarClienteModal${cliente.id}\" tabindex=\"-1\" role=\"dialog\" aria-labelledby=\"clientesModalLabel\" aria-hidden=\"true\">\r\n                            <div class=\"modal-dialog\" role=\"document\">\r\n                                <div class=\"modal-content\">\r\n                                    <div class=\"modal-header\">\r\n                                        <h5 class=\"modal-title\" id=\"clientesModalLabel\">Editar Cliente</h5>\r\n                                        <button type=\"button\" class=\"close\" data-dismiss=\"modal\" aria-label=\"Close\">\r\n                                            <span aria-hidden=\"true\">&times;</span>\r\n                                        </button>\r\n                                    </div>\r\n                                    <div class=\"modal-body\">\r\n                                        <form method=\"POST\">\r\n                                            <div class=\"form-group\">\r\n                                                <label for=\"nombre\">Nombre</label>\r\n                                                <input type=\"text\" class=\"form-control\" id=\"nombre${cliente.id}\" name=\"nombre\" value=\"${cliente.nombre}\" />\r\n                                            </div>\r\n                                            <div class=\"form-group\">\r\n                                                <label for=\"apellidos\">Apellidos</label>\r\n                                                <input type=\"text\" class=\"form-control\" id=\"apellidos${cliente.id}\" name=\"apellidos\" value=\"${cliente.apellidos}\" />\r\n                                            </div>\r\n                                            <div class=\"form-group\">\r\n                                                <label for=\"correo\">Correo</label>\r\n                                                <input type=\"email\" class=\"form-control\" id=\"correo${cliente.id}\" name=\"correo\" value=\"${cliente.correo}\" />\r\n                                            </div>\r\n                                            <div class=\"form-group\">\r\n                                                <label for=\"telefono\">Telefono</label>\r\n                                                <input type=\"text\" class=\"form-control\" id=\"telefono${cliente.id}\" name=\"telefono\" value=\"${cliente.telefono}\" />\r\n                                            </div>\r\n                                            <div class=\"form-group\">\r\n                                                <label for=\"documento_identidad\">DNI</label>\r\n                                                <input type=\"text\" class=\"form-control\" id=\"documento_identidad${cliente.id}\" name=\"documento_identidad\" value=\"${cliente.documento_identidad}\" />\r\n                                            </div>\r\n                                            <div class=\"form-group\">\r\n                                                <label for=\"fecha_nacimiento\">Fecha de Nacimiento</label>\r\n                                                <input type=\"date\" class=\"form-control\" id=\"fecha_nacimiento${cliente.id}\" name=\"fecha_nacimiento\" value=\"${cliente.fecha_nacimiento}\" />\r\n                                            </div>\r\n                                            <div class=\"modal-footer\">\r\n                                                <button type=\"button\" class=\"btn btn-secondary\" data-dismiss=\"modal\">Cerrar</button>\r\n                                                <button type=\"button\" class=\"btn btn-primary btn-actualizarCliente\" data-id=\"${cliente.id}\">Guardar</button>\r\n                                            </div>\r\n                                        </form>\r\n                                    </div>\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n\r\n                        <!-- Botón de eliminar -->\r\n                        <form method=\"POST\" action=\"/admin/clientes/eliminar\" class=\"d-inline\">\r\n                            <input type=\"hidden\" name=\"id\" value=\"${cliente.id}\">\r\n                            <button class=\"btn btn-sm btn-danger\" type=\"submit\">\r\n                                <i class=\"fa-solid fa-trash\"></i>\r\n                            </button>\r\n                        </form>\r\n                    </td>\r\n                `;\r\n                tableBody.appendChild(row); \r\n            });\r\n\r\n            // Delegación para actualizar cliente\r\n            tableBody.addEventListener('click', function(e) {\r\n                if (e.target.classList.contains('btn-actualizarCliente')) {\r\n                    const clienteId = e.target.getAttribute('data-id');\r\n                    actualizarCliente(clienteId);\r\n                }\r\n            });\r\n\r\n            // Subir actualización del cliente\r\n            function actualizarCliente(id) {\r\n                const nombre = document.querySelector(`#nombre${id}`).value.trim();\r\n                const apellidos = document.querySelector(`#apellidos${id}`).value.trim();\r\n                const correo = document.querySelector(`#correo${id}`).value.trim();\r\n                const telefono = document.querySelector(`#telefono${id}`).value.trim();\r\n                const documento_identidad = document.querySelector(`#documento_identidad${id}`).value.trim();\r\n                const fecha_nacimiento = document.querySelector(`#fecha_nacimiento${id}`).value;\r\n\r\n                const cliente = {\r\n                    id,\r\n                    nombre,\r\n                    apellidos,\r\n                    correo,\r\n                    telefono,\r\n                    documento_identidad,\r\n                    fecha_nacimiento\r\n                };\r\n\r\n                subirActualizacionCliente(cliente);\r\n            }\r\n\r\n            async function subirActualizacionCliente(cliente) {\r\n                //console.log(`Se está actualizando el cliente: ${cliente.nombre} ${cliente.apellidos}`);\r\n                // Conatruir peticion\r\n                const datos = new FormData();\r\n                datos.append('id', cliente.id);\r\n                datos.append('nombre', cliente.nombre);\r\n                datos.append('apellidos', cliente.apellidos);\r\n                datos.append('correo', cliente.correo);\r\n                datos.append('telefono', cliente.telefono);\r\n                datos.append('documento_identidad', cliente.documento_identidad);\r\n                datos.append('fecha_nacimiento', cliente.fecha_nacimiento);\r\n\r\n                try {\r\n                    const url = 'http://localhost:3000/api/clientes/actualizar';\r\n                    const respuesta = await fetch(url, {\r\n                        method: 'POST',\r\n                        body: datos\r\n                    });\r\n\r\n                    const resultado = await respuesta.json();\r\n                    console.log(resultado);\r\n                } catch (error) {\r\n                    console.log(error);\r\n                }\r\n            }\r\n\r\n        } catch (error) {\r\n            console.log(error);\r\n        }\r\n    }\r\n\r\n})();\r\n","(function () {\r\n    let dataTable;\r\n    let dataTableInit = false;\r\n\r\n    // Opciones de DataTables\r\n    const dataTableOption = {\r\n        destroy: true,\r\n        language: {\r\n            url: 'https://cdn.datatables.net/plug-ins/2.1.8/i18n/es-MX.json',\r\n        },\r\n        columnDefs: [\r\n            { orderable: false, targets: [3, 4, 8] }  // Desactiva la ordenación en la columna 8 (índice 7)\r\n        ]\r\n    };\r\n\r\n\r\n    // Diccionarios para roles y estatus\r\n    const roles = {\r\n        1: 'Administrador',\r\n        2: 'Empleado General',\r\n        3: 'Limpieza'\r\n    };\r\n\r\n    const estatus = {\r\n        1: 'Activo',\r\n        0: 'Inactivo'\r\n    };\r\n\r\n    // Función para inicializar la DataTable\r\n    async function initDataTable() {\r\n        if (dataTableInit) {\r\n            dataTable.destroy();  // Destruye la DataTable si ya existe\r\n        }\r\n\r\n        await listarUsers();  // Llama a la función para listar usuarios\r\n\r\n        // Inicializa la DataTable\r\n        dataTable = $(\"#datatable_users\").DataTable(dataTableOption);\r\n\r\n        dataTableInit = true;  // Marca que la DataTable fue inicializada\r\n    }\r\n\r\n    // Función para listar los usuarios\r\n    async function listarUsers() {\r\n        try {\r\n            const url = 'http://localhost:3000/api/usuarios/listar';\r\n            const resultado = await fetch(url);\r\n            const usuarios = await resultado.json();\r\n\r\n            // Selecciona el cuerpo de la tabla\r\n            const tableBody = document.getElementById('tableBody_users');\r\n\r\n            // Limpia el contenido del tbody antes de agregar nuevas filas\r\n            tableBody.innerHTML = '';\r\n\r\n            // Recorre los usuarios y genera las filas de la tabla\r\n            usuarios.forEach((usuario, index) => {\r\n                // Crea una nueva fila\r\n                const row = document.createElement('tr');\r\n\r\n                // Agrega celdas (td) a la fila con la información que quieres mostrar\r\n                row.innerHTML = `\r\n                    <td>${index + 1}</td> \r\n                    <td>${usuario.nombre}</td>\r\n                    <td>${usuario.apellido}</td>\r\n                    <td>${usuario.direccion}</td>\r\n                    <td>${usuario.email}</td>\r\n                    <td>${roles[usuario.rol_id]}</td> <!-- Muestra el rol legible -->\r\n                    <td>${estatus[usuario.estatus]}</td> <!-- Muestra el estatus legible -->\r\n                    <td>${usuario.fecha_creacion}</td>\r\n                    <td>\r\n                        <!-- Botón de editar -->\r\n                        <button class=\"btn btn-sm btn-primary\">\r\n                            <i class=\"fa-solid fa-pen\"></i>\r\n                        </button>\r\n\r\n                        <!-- Formulario para eliminar -->\r\n                        <form method=\"POST\" action=\"/admin/usuarios/eliminar\" class=\"d-inline\">\r\n                            <input type=\"hidden\" name=\"id\" value=\"${usuario.id}\">\r\n                            <button class=\"btn btn-sm btn-danger\" type=\"submit\">\r\n                                <i class=\"fa-solid fa-trash\"></i>\r\n                            </button>\r\n                        </form>\r\n                    </td>\r\n                `;\r\n\r\n                // Agrega la fila a la tabla\r\n                tableBody.appendChild(row);\r\n            });\r\n\r\n        } catch (error) {\r\n            console.log(error);\r\n        }\r\n    }\r\n\r\n    // Ejecuta la función cuando la ventana cargue\r\n    window.addEventListener('load', async () => {\r\n        await initDataTable();\r\n    });\r\n})();\r\n"]}